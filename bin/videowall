#!/usr/bin/env python3
"""
Main launcher entry point for VideoWall.
"""
import sys
import os

def main():
    """Launcher main function."""
    # Load and validate config
    import json
    from jsonschema import validate, ValidationError

    config_path = os.path.expanduser("~/.config/videowall/config.json")
    schema_path = os.path.join(os.path.dirname(__file__), '..', 'docs', 'config-schema.json')
    try:
        with open(schema_path) as f:
            schema = json.load(f)
        with open(config_path) as f:
            config = json.load(f)
        validate(config, schema)
    except FileNotFoundError as e:
        print(f"Config/schema file not found: {e}", file=sys.stderr)
        sys.exit(1)
    except ValidationError as e:
        print(f"Configuration validation error: {e.message}", file=sys.stderr)
        sys.exit(1)

    # Build mpv command
    mpv_cmd = [
        'mpv', '--fullscreen',
        '--script=' + os.path.join(os.path.expanduser('~/.config/videowall'), 'player.lua')
    ] + config.get('video_dirs', [])
    os.execvp(mpv_cmd[0], mpv_cmd)

if __name__ == "__main__":
    sys.exit(main())
